---
name: 가이드 & 관리자 대시보드
status: done
created: 2025-12-03T13:45:12Z
updated: 2025-12-04T12:00:00Z
github: [Will be updated when synced to GitHub]
depends_on: [003, 005]
parallel: true
conflicts_with: [006, 007]
---

# Task: 가이드 & 관리자 대시보드

## Description

로컬 가이드(Guide)와 슈퍼관리자(Admin)가 사용하는 대시보드를 구현합니다. 가이드는 배정된 일정 확인 및 QR 체크인을, 관리자는 전체 플랫폼 관리 및 통계를 담당합니다.

## Acceptance Criteria

### 가이드 대시보드
- [ ] 배정된 투어 일정 목록
- [ ] 캘린더 형태 일정 조회
- [ ] 투어 상세 정보 (고객 정보, 장소)
- [ ] QR 코드 체크인 기능
- [ ] 투어 시작/종료 처리
- [ ] 노쇼 보고

### 관리자 대시보드
- [ ] 전체 통계 대시보드 (트래픽, 예약, 매출)
- [ ] 사용자 관리 (목록, 상세, 활성화/비활성화)
- [ ] 제공자 승인/거절
- [ ] 상품 관리 (승인, 비활성화)
- [ ] 예약 관리 (목록, 분쟁 처리)
- [ ] 신고 처리
- [ ] 노쇼 관리 (제한/해제)

## Technical Details

### 가이드 페이지 구조

```
resources/views/guide/
├── dashboard.blade.php          # 메인 (오늘 일정)
├── schedules/
│   ├── index.blade.php          # 전체 일정 (캘린더)
│   └── show.blade.php           # 투어 상세
├── checkin/
│   └── index.blade.php          # QR 체크인 페이지
└── layouts/
    └── guide.blade.php
```

### 관리자 페이지 구조

```
resources/views/admin/
├── dashboard.blade.php          # 통계 대시보드
├── users/
│   ├── index.blade.php          # 사용자 목록
│   └── show.blade.php           # 사용자 상세
├── vendors/
│   ├── index.blade.php          # 제공자 목록 (승인 대기)
│   └── show.blade.php           # 제공자 상세
├── products/
│   ├── index.blade.php          # 상품 목록
│   └── show.blade.php           # 상품 상세
├── bookings/
│   └── index.blade.php          # 예약 목록
├── reports/
│   ├── index.blade.php          # 신고 목록
│   └── show.blade.php           # 신고 상세
├── no-shows/
│   └── index.blade.php          # 노쇼 관리
└── layouts/
    └── admin.blade.php
```

### Vue.js 컴포넌트

```
resources/js/components/
├── guide/
│   ├── TodaySchedule.vue        # 오늘 일정 목록
│   ├── ScheduleCalendar.vue     # 가이드용 캘린더
│   ├── QRScanner.vue            # QR 스캐너 (카메라)
│   └── CheckinConfirm.vue       # 체크인 확인 모달
└── admin/
    ├── StatsDashboard.vue       # 통계 차트
    ├── UserTable.vue            # 사용자 테이블
    ├── VendorApproval.vue       # 제공자 승인 UI
    ├── ReportHandler.vue        # 신고 처리 UI
    └── NoShowManager.vue        # 노쇼 관리 UI
```

### QRScanner.vue

```vue
<template>
  <div class="qr-scanner">
    <video ref="video" class="camera-feed"></video>

    <div v-if="scannedBooking" class="booking-info">
      <h3>예약 정보</h3>
      <p>예약번호: {{ scannedBooking.id }}</p>
      <p>고객명: {{ scannedBooking.user.name }}</p>
      <p>인원: 성인 {{ scannedBooking.adult_count }}, 아동 {{ scannedBooking.child_count }}</p>

      <button @click="confirmCheckin" class="btn-success">
        체크인 확인
      </button>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import { BrowserQRCodeReader } from '@zxing/library'

const video = ref(null)
const scannedBooking = ref(null)
const codeReader = new BrowserQRCodeReader()

onMounted(async () => {
  const result = await codeReader.decodeFromVideoDevice(null, video.value, (result) => {
    if (result) {
      fetchBooking(result.getText())
    }
  })
})

onUnmounted(() => {
  codeReader.reset()
})

async function fetchBooking(bookingCode) {
  const response = await axios.get(`/guide/bookings/${bookingCode}`)
  scannedBooking.value = response.data
}

async function confirmCheckin() {
  await axios.post(`/guide/checkin/${scannedBooking.value.id}`)
  alert('체크인 완료!')
  scannedBooking.value = null
}
</script>
```

### 관리자 통계 API

```php
// app/Http/Controllers/Admin/DashboardController.php
public function index()
{
    return view('admin.dashboard', [
        'stats' => [
            // 트래픽 (Google Analytics API 또는 자체 로그)
            'daily_visitors' => $this->getVisitorStats('day'),
            'weekly_visitors' => $this->getVisitorStats('week'),
            'monthly_visitors' => $this->getVisitorStats('month'),

            // 예약
            'total_bookings' => Booking::count(),
            'pending_bookings' => Booking::where('status', 'pending')->count(),
            'completed_bookings' => Booking::where('status', 'completed')->count(),
            'cancelled_bookings' => Booking::where('status', 'cancelled')->count(),
            'booking_completion_rate' => $this->calculateCompletionRate(),

            // 사용자
            'total_users' => User::count(),
            'new_users_this_month' => User::whereMonth('created_at', now()->month)->count(),
            'pending_vendors' => Vendor::where('status', 'pending')->count(),

            // 상품
            'total_products' => Product::count(),
            'active_products' => Product::where('status', 'active')->count(),

            // 신고
            'pending_reports' => Report::where('status', 'pending')->count(),
        ],
        'charts' => [
            'bookings_by_region' => $this->getBookingsByRegion(),
            'bookings_trend' => $this->getBookingsTrend(),
            'popular_products' => $this->getPopularProducts(),
        ],
    ]);
}
```

### 가이드 라우트

```php
Route::middleware(['auth', 'role:guide'])->prefix('guide')->name('guide.')->group(function () {
    Route::get('/', [Guide\DashboardController::class, 'index'])->name('dashboard');
    Route::get('/schedules', [Guide\ScheduleController::class, 'index'])->name('schedules.index');
    Route::get('/schedules/{booking}', [Guide\ScheduleController::class, 'show'])->name('schedules.show');
    Route::get('/checkin', [Guide\CheckinController::class, 'index'])->name('checkin.index');
    Route::post('/checkin/{booking}', [Guide\CheckinController::class, 'store'])->name('checkin.store');
    Route::patch('/bookings/{booking}/start', [Guide\BookingController::class, 'start']);
    Route::patch('/bookings/{booking}/complete', [Guide\BookingController::class, 'complete']);
    Route::patch('/bookings/{booking}/no-show', [Guide\BookingController::class, 'noShow']);
});
```

### 관리자 라우트

```php
Route::middleware(['auth', 'role:admin'])->prefix('admin')->name('admin.')->group(function () {
    Route::get('/', [Admin\DashboardController::class, 'index'])->name('dashboard');

    // 사용자
    Route::get('/users', [Admin\UserController::class, 'index'])->name('users.index');
    Route::get('/users/{user}', [Admin\UserController::class, 'show'])->name('users.show');
    Route::patch('/users/{user}/toggle', [Admin\UserController::class, 'toggle']);

    // 제공자
    Route::get('/vendors', [Admin\VendorController::class, 'index'])->name('vendors.index');
    Route::get('/vendors/{vendor}', [Admin\VendorController::class, 'show'])->name('vendors.show');
    Route::patch('/vendors/{vendor}/approve', [Admin\VendorController::class, 'approve']);
    Route::patch('/vendors/{vendor}/reject', [Admin\VendorController::class, 'reject']);

    // 상품
    Route::get('/products', [Admin\ProductController::class, 'index'])->name('products.index');
    Route::get('/products/{product}', [Admin\ProductController::class, 'show'])->name('products.show');
    Route::patch('/products/{product}/toggle', [Admin\ProductController::class, 'toggle']);

    // 예약
    Route::get('/bookings', [Admin\BookingController::class, 'index'])->name('bookings.index');
    Route::patch('/bookings/{booking}/cancel', [Admin\BookingController::class, 'cancel']);

    // 신고
    Route::get('/reports', [Admin\ReportController::class, 'index'])->name('reports.index');
    Route::get('/reports/{report}', [Admin\ReportController::class, 'show'])->name('reports.show');
    Route::patch('/reports/{report}/handle', [Admin\ReportController::class, 'handle']);

    // 노쇼
    Route::get('/no-shows', [Admin\NoShowController::class, 'index'])->name('no-shows.index');
    Route::patch('/users/{user}/unblock', [Admin\NoShowController::class, 'unblock']);
});
```

## Dependencies

- [ ] Task 003 완료 (인증, 역할)
- [ ] Task 005 완료 (예약 API)
- [ ] simple-qrcode 패키지 설치됨
- [ ] @zxing/library (QR 스캐너) npm 설치

## Effort Estimate

- Size: M
- Complexity: Medium
- Parallel: true (Task 006, 007과 충돌 가능)

## Definition of Done

### 가이드
- [ ] 오늘 배정된 일정 목록 확인
- [ ] 캘린더에서 전체 일정 조회
- [ ] QR 코드 스캔으로 체크인 처리
- [ ] 투어 시작/종료 처리 동작
- [ ] 노쇼 보고 동작

### 관리자
- [ ] 통계 대시보드 차트 표시
- [ ] 사용자 목록/상세/활성화 토글 동작
- [ ] 제공자 승인/거절 동작
- [ ] 상품 목록/비활성화 동작
- [ ] 신고 목록/처리 동작
- [ ] 노쇼 사용자 제한/해제 동작